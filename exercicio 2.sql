SELECT name, sum(amount) FROM customers c INNER JOIN orders o on (c.id = o.customer_id) GROUP BY c.id;